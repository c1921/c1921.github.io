# 制作流程

1. OCR
2. 统一所有括号为中文括号
3. 标题分级
   1. 篇
   2. 章
      1. 使用正则表达式`^第.*章$`查找，并规范格式（编号与名称中间两空格）
      2. 使用正则表达式`(^第.*章.*)`查找
      3. 替换为`<h1>$1</h1>`
   3. 节，即`1．`，使用正则表达式`(^([0-9]*)(\.|．)\D.*)`查找
   4. 小节，即`A．`，使用正则表达式`(^([A-Z]*)(\.|．)\D.*)`查找
   5. 段落，即`（1）`，使用正则表达式`(^（[0-9*]）.*)`查找
   6. 小段，即`（a）`，使用正则表达式`(^（[a-z*]）.*)`查找
4. 标题点号替换为全形句号
   1. 使用正则表达式`(\<h\d\>.*)(\.)(.*\</h\d\>)`查找
   2. 替换为`$1．$3`
5. 将脚注序号的中文括号替换为英文括号
   1. 使用正则表达式`（([0-9a-z?]*)）`查找
   2. 替换为`($1)`
6. 更正标题序号括号
   1. 使用正则表达式`>\(([0-9a-z?]*)\)`查找
   2. 替换为`>（$1）`
7. 标题添加 id

   1. 使用正则表达式 `<(h\d)>(.*)(</h\d>)`查找

   2. 替换为 `<$1 id="$2">$2$3`
8. 章添加换行
9. 整理文本，分离正文与脚注
10. 更正带圆圈数字（①②③④⑤⑥⑦⑧⑨⑩⑪⑫⑬⑭⑮⑯⑰⑱⑲⑳㉑㉒㉓㉔㉕㉖㉗㉘㉙㉚㉛㉜㉝㉞㉟㊱㊲㊳㊴㊵㊶㊷㊸㊹㊺㊻㊼㊽㊾㊿）顺序
11. 更正括号数字顺序（序与跋）
12. 正文添加`<p>`标签
    1. 使用正则表达式`^((?!<).*)`查找
    2. 替换为`<p>$1</p>`
13. 在**正文**中为脚注序号添加标签
    1. 使用正则表达式`(\([0-9a-z?]*\)|①|②|③|④|⑤|⑥|⑦|⑧|⑨|⑩|⑪|⑫|⑬|⑭|⑮|⑯|⑰|⑱|⑲|⑳|㉑|㉒|㉓|㉔|㉕|㉖|㉗|㉘|㉙|㉚|㉛|㉜|㉝|㉞|㉟|㊱|㊲|㊳|㊴|㊵|㊶|㊷|㊸|㊹|㊺|㊻|㊼|㊽|㊾|㊿)`查找
    2. 替换为`<sup class="a-footnote"><a href="#b-footnote-$1" name="a-footnote-$1">$1</a></sup>`
14. 在**脚注**中添加标签
    1. 使用正则表达式`^(\([0-9a-z?]*\)|①|②|③|④|⑤|⑥|⑦|⑧|⑨|⑩|⑪|⑫|⑬|⑭|⑮|⑯|⑰|⑱|⑲|⑳|㉑|㉒|㉓|㉔|㉕|㉖|㉗|㉘|㉙|㉚|㉛|㉜|㉝|㉞|㉟|㊱|㊲|㊳|㊴|㊵|㊶|㊷|㊸|㊹|㊺|㊻|㊼|㊽|㊾|㊿)(.*)$`查找
    2. 替换为`<div class="footnote-line"><a class="b-footnote" name="b-footnote-$1" href="#a-footnote-$1">$1</a>$2<a href="#a-footnote-$1" title="回到文档" class="reversefootnote" >↩</a></div>`
15. 合并正文与脚注
16. 为引用添加标签`<blockquote>` `</blockquote>`
17. 署名、日期格式
